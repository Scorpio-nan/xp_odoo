## 顺丰速递解决方案

顺丰速运作为国内快递业的标杆企业，使用的频率可谓非常之高。对odoo国内生态而言，怎么能少了如此重要的一个对接方案呢。本文将展示如何使用[顺丰速递](https://hub.mixoo.cn/shop/8)模块来完成国内快递业务的对接。

## 先决条件

> 适用于：15.0 16.0 17.0，不同版本功能有所不同, 详询客服。

需要安装以下python库：

```sh
autils == 0.3.12
sf-sdk >= 2.0.0.8
```

## 丰桥对接

要使用顺丰模块，首先我们要注册一个[丰桥](https://open.sf-express.com/)(顺丰API开放平台)账号，然后拿到**客户编码**、**校验码**和**月结号**。

1. 首先，我们进入丰桥首页，点击开发者对接，新建一个应用。

    ![sf1](./images/sf1.png)

2. 填入应用名称，开发者语言和应用描述，是否设置沙箱白名单保持默认选项，点击完成。

    ![sf2](./images/sf2.png)

3. 完成应用创建之后，点击查看API，关联我们需要的API。

    ![sf3](./images/sf3.png)

4. 顺丰模块需要的API列表如下：

    * 云打印面单接口
    * isv获取商家自定义模板列表
    * 下订单接口
    * 订单结果查询接口
    * 订单取消接口
    * 订单筛选接口
    * 路由查询接口

5. 回到应用，点击应用详情，获取**顾客编码**，**月结卡号**和**校验码**。

    ![sf4](./images/sf4.png)

完成上面5步我们就完成了顺丰对接的基本设置。



## 模块配置

接下来，我们来配置我们的顺丰模块。

1. 首先，安装顺丰速运模块：

    ![sf5](./images/sf5.png)

2. 再库存-设置-送货方式中点击顺丰速运：

    ![sf6](./images/sf6.png)

3. 打开顺丰速运设置，把月结卡号、顾客编码和校验码填入到基础设置中。

    ![sf7](./images/sf7.png)

4. 获取电子面单编码

    ![sf9](./images/sf9.png)

    ![sf10](./images/sf10.png)

    把我们获取到的面单编码填到订单设置中的面单编码中。


至此，我们就完成了顺丰模块的基本配置。

## 使用说明

下面我们来详细介绍顺丰模块的具体功能。

> 丰桥平台要求API续测试3次成功以后才可以接入生产，因此我们在开始使用的时候应用首先使用沙箱校验码，完成测试以后再换成生产校验码。

### 1. 下单

我们手动创建一个调拨单，承运方选择顺丰速运，填入货物描述(货物/文件等等)

![](./images/sf8.png)

然后我们点击标记待办，最后点击验证，完成出库。

完成出库后，我们可以看到生成了电子面单。

![sf11](./images/sf11.png)

### 2. 取消订单

在物流跟踪旁边点击取消按钮，可以取消订单。

![sf12](images/sf12.png)

### 3. 物流跟踪

当我们每次打开发货单时，模块都会帮我们自动更新订单的当前路由信息。我们可以手动点击更新按钮，实时获取最新的物流信息。也可以点击右上角的物流跟踪按钮到顺丰官网进行查询。

![sf13](./images/sf13.png)

### 4. 自定义顺丰源单号

我们提供了三种源单号的生成方式：

* 使用发货单号作为顺丰订单的源单号，即SO/OUT/XXX类似的单号直接作为顺丰的源单号。
* 使用发货单的源单号作为顺丰订单的源单号，即PO0001/SO0001等源单据的单号作为顺丰订单号
* 使用随机字符串作为顺丰订单的源单号，即使用发货单号+4位随机字符串的方式生成顺丰订单号。例如WH/OUT/00015-r9jc。

### 5. 自定义发货地址类型

我们同时提供了三种发货地址的设置方式：

* 使用当前公司地址作为发货地址： 适用于统一发货地址的发货方式。
* 使用发货仓库地址作为发货地址： 适用于公司地址和发货仓库不在一块且有多个仓库的发货方式。
* 使用固定地址作为发货地址： 指定固定的发货地址作为订单的发货地址。

另外，我们也支持自定义地址的格式，如同销售订单的地址格式自定义一样。

### 6. 跨境支持

对于跨境业务，顺丰要求必须申报货物价值，因此，我们加入了申报货物价值的支持。

![sf14](./images/sf14.png)

如果您的发货地或收货地址在境外，此项为必填。

### 7. 语言支持

我们同时支持多语言设置，可以根据系统改变或指定固定的语言格式。

![sf15](./images/sf15.png)

### 8. 批量打印面单

为了方便用户统一下单和获取电子面单，本模块增加了批量打印电子面单的功能。

> 版本要求：15.7.7+,16.8.0+


## FAQ

### 1. 网站下单时预估价格没有显示

请检查发货地址和目的地址是否合法，可以根据后台日志提示进行诊断。
